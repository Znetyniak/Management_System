{% extends 'base.html' %}
{% block title %}Manage Vehicles{% endblock %}

{% block content %}
<h1>Manage Vehicles</h1>

<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
  <form method="get" style="display:flex;gap:8px">
    <input name="q" placeholder="Search brand/model/vin" value="{{ request.args.get('q','') }}">
    <button class="button" type="submit">Search</button>
  </form>

  <div style="display:flex;gap:8px">
    <a class="button" href="{{ url_for('admin.add_car') }}">Add vehicle</a>

    <form id="bulk-delete-form" method="POST" action="{{ url_for('admin.delete_selected_cars') }}">
      <input type="hidden" name="ids" id="bulk-ids-field">
      <button type="submit" class="button danger" id="bulk-delete-btn">Delete selected</button>
    </form>
  </div>
</div>


<table class="table" id="vehicles-table">
  <thead>
    <tr>
      <th><input id="select-all" type="checkbox"></th>
      <th>ID</th>
      <th>Brand</th>
      <th>Model</th>
      <th>Year</th>
      <th>VIN</th>
      <th>State</th>
      <th>Actions</th>
    </tr>
  </thead>

  <tbody>
    {% for v in vehicles %}
    <tr>
      <td><input type="checkbox" class="row-check" value="{{ v.id }}"></td>
      <td>{{ v.id }}</td>
      <td>{{ v.brand }}</td>
      <td>{{ v.model }}</td>
      <td>{{ v.year }}</td>
      <td>{{ v.vin }}</td>
      <td>{{ v.technical_state }}</td>
      <td>
        <a href="{{ url_for('admin.edit_car', vid=v.id) }}">Edit</a>
        |
        <form method="POST" action="{{ url_for('admin.delete_car', vid=v.id) }}"
              style="display:inline" onsubmit="return confirm('Delete this vehicle?');">
          <button type="submit" style="background:none;border:none;color:#d9534f;cursor:pointer">
            Delete
          </button>
        </form>
      </td>
    </tr>
    {% else %}
    <tr><td colspan="8">No vehicles found.</td></tr>
    {% endfor %}
  </tbody>
</table>

{% include 'includes/_pagination.html' %}

<!-- Підключаємо JS -->
<script src="{{ url_for('static', filename='js/admin_manage_cars.js') }}"></script>

{% endblock %}
